<div class="max-w-4xl mx-auto my-5 p-5">
  <h1 class="text-2xl font-bold mb-4">Admin Panel</h1>

  <div class="my-5">
    <a href="/" class="no-underline hover:underline">&larr; Back to Chat</a>
  </div>

  <h2 class="text-xl font-semibold mb-3">Create Magic Link</h2>
  <form method="post" action="/admin/create-link" class="my-5 p-5 border border-3 border-dashed border-terminal-green-500">
    <div class="my-2">
      <label for="expires_hours" class="block mb-1">Expires in (hours, leave empty for permanent):</label>
      <input type="number" id="expires_hours" name="expires_hours" min="1" class="p-1 w-28 border border-terminal-green-500 border-2">
    </div>
    <%= submit_button('Create Link') %>
  </form>

  <h2 class="text-xl font-semibold mb-3">Active Magic Links</h2>
  <% if @magic_links.empty? %>
    <p class="text-gray-600">No active magic links.</p>
  <% else %>
    <div class="my-5">
      <% @magic_links.each do |link| %>
        <div class="border border-3 border-dashed border-terminal-green-500 p-4 my-2">
          <div class="my-1"><strong>Link:</strong>
            <code class="px-1 py-0.5 break-all text-sm bg-black/50">
              http://<%= request.host_with_port %>/setup?token=<%= link[:token] %>
            </code>
          </div>
          <div class="my-1"><strong>Created:</strong> <%= link[:created_at] %></div>
          <div class="my-1"><strong>Used:</strong> <%= link[:used_count] %> times</div>
          <% if link[:expires_at] %>
            <div class="my-1"><strong>Expires:</strong> <%= link[:expires_at] %></div>
          <% else %>
            <div class="my-1"><strong>Expires:</strong> Never</div>
          <% end %>
          <form method="post" action="/admin/deactivate-link/<%= link[:id] %>" class="my-2">
            <button type="submit" class="py-1 px-2 bg-red-600 text-white border-0 hover:bg-red-700 cursor-pointer">Deactivate</button>
          </form>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
